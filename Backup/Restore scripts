Backup/Restore scripts (templates)
scripts/backup.sh
#!/usr/bin/env bash
set -euo pipefail

AWS_REGION="${AWS_REGION:-us-east-1}"

# Choose based on what you used:
RDS_INSTANCE_ID="${RDS_INSTANCE_ID:-}"
DOCDB_CLUSTER_ID="${DOCDB_CLUSTER_ID:-}"
OPENSEARCH_DOMAIN="${OPENSEARCH_DOMAIN:-}"
EFS_FS_ID="${EFS_FS_ID:-}"
EBS_VOLUME_ID="${EBS_VOLUME_ID:-}"

TS="$(date +%Y%m%d-%H%M%S)"

echo "==> Starting backups: $TS"

if [[ -n "$RDS_INSTANCE_ID" ]]; then
  echo "Backing up RDS snapshot..."
  aws rds create-db-snapshot \
    --region "$AWS_REGION" \
    --db-instance-identifier "$RDS_INSTANCE_ID" \
    --db-snapshot-identifier "${RDS_INSTANCE_ID}-${TS}"
fi

if [[ -n "$DOCDB_CLUSTER_ID" ]]; then
  echo "Backing up DocumentDB snapshot..."
  aws docdb create-db-cluster-snapshot \
    --region "$AWS_REGION" \
    --db-cluster-identifier "$DOCDB_CLUSTER_ID" \
    --db-cluster-snapshot-identifier "${DOCDB_CLUSTER_ID}-${TS}"
fi

if [[ -n "$EFS_FS_ID" ]]; then
  echo "EFS backup: use AWS Backup plan or EFS-to-S3 job (documented in docs/decisions.md)"
fi

if [[ -n "$EBS_VOLUME_ID" ]]; then
  echo "Creating EBS snapshot..."
  aws ec2 create-snapshot --region "$AWS_REGION" --volume-id "$EBS_VOLUME_ID" --description "openedx-ebs-${TS}"
fi

echo "==> Backup completed: $TS"

scripts/restore.sh
#!/usr/bin/env bash
set -euo pipefail

echo "Restore is environment-specific."
echo "Document exact restore steps in docs/deployment-guide.md based on your chosen services."
exit 0
